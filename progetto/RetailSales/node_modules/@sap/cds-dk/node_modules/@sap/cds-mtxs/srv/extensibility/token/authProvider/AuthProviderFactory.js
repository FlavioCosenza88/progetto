const ClientCredentialsAuthProvider = require('./ClientCredentialsAuthProvider');
const PasswordAuthProvider = require('./PasswordAuthProvider');
const RefreshTokenAuthProvider = require('./RefreshTokenAuthProvider');

module.exports = class AuthProviderFactory {

    static getAuthProvider(credentials, query) {
        return query.refresh_token
            ? new RefreshTokenAuthProvider(credentials, query)
            : query.passcode
                ? new PasswordAuthProvider(credentials, query)
                : query.clientid
                    ? new ClientCredentialsAuthProvider(credentials, query)
                    : new Error('Unknown grant type');
    }
}
